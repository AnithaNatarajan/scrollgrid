!function(a,b){"use strict";if("object"==typeof exports)module.exports=b(require("d3"));else if("function"==typeof define&&define.amd)define(["d3"],function(c){return a.Scrollgrid=b(c),a.Scrollgrid});else if(a.d3)a.Scrollgrid=b(a.d3);else{if(!console||!console.warn)throw"scrollgrid requires d3 to run.  Are you missing a reference to the d3 library?";console.warn("scrollgrid requires d3 to run.  Are you missing a reference to the d3 library?")}}(this,function(a){"use strict";var b=function(b){var c,d=this.internal;b=b||{},b.target?1!==a.select(b.target).length?d.raise('target should be a d3/jquery selector identifying a single div.  E.g. "#tableContainer" where you have a div with id "tableContainer".  Please check that your selector is matching 1 and only 1 div.'):(this.elements={},this.eventHandlers=[],this.properties={},c=this.properties,c.rowHeight=b.rowHeight||30,c.dragHandleWidth=b.dragHandleWidth||8,c.headerRowHeight=b.headerRowHeight||c.rowHeight,c.footerRowHeight=b.footerRowHeight||c.rowHeight,c.defaultColumnWidth=b.defaultColumnWidth||100,c.cellPadding=b.cellPadding||6,c.allowColumnResizing=b.allowColumnResizing||!0,c.allowSorting=b.allowSorting||!0,c.virtualTop=b.headerRows||0,c.virtualBottom=b.footerRows||0,c.virtualLeft=b.headerColumns||0,c.virtualRight=b.footerColumns||0,this.target=b.target,d.render.setDefaultStyles.call(this),c.formatRules=b.formatRules||[],c.cellWaitText=b.cellWaitText||"loading...",c.sortIconSize=b.sortIconSize||7,d.dom.populateDOM.call(this),this.data(b.data||b.adapter),b.autoResize&&d.dom.setAutoResize.call(this)):d.raise('target is a required field, please provide a selector string for the container. The selector string should be a d3/jquery selector identifying a single div.  E.g. "#tableContainer" where you have a div with id "tableContainer".')};return b.init=function(a,c){c=c||{},c.target=a;var d=new b(c);return d},b.adapters={},b.prototype.internal={sizes:{},events:{},interaction:{},dom:{},render:{}},b}),Scrollgrid.prototype.internal.dom.getTopMargin=function(a,b){"use strict";var c,d=this.properties,e=0;return a&&a.height&&b&&("middle"===d.verticalAlignment?(c=b.node().offsetHeight,e=(c-a.height)/2):"bottom"===d.verticalAlignment&&(c=b.node().offsetHeight,e=c-a.height-1)),e},Scrollgrid.prototype.internal.dom.layoutDOM=function(a){"use strict";var b,c=this,d=c.internal,e=c.properties,f=c.elements;f.parent.style("position","relative"),b=d.dom.getTopMargin.call(c,a,f.parent),f.container.style("position","relative").style("width",a&&a.width?a.width+"px":"100%").style("height",a&&a.height?a.height+"px":"100%").style("padding-top",b+"px").style("font-size",0),f.container.node().offsetWidth>f.parent.node().offsetWidth&&f.container.style("width","100%"),f.container.node().offsetHeight>f.parent.node().offsetHeight&&f.container.style("margin-top","0px").style("height","100%"),d.sizes.calculatePhysicalBounds.call(c,b),d.dom.setAbsolutePosition.call(c,f.left.svg,0,e.physicalTop+b,e.physicalLeft,e.physicalVisibleInnerHeight),d.dom.setRelativePosition.call(c,f.top.svg,e.physicalLeft,e.physicalVisibleInnerWidth,e.physicalTop,"hidden"),d.dom.setRelativePosition.call(c,f.main.viewport,e.physicalLeft,e.physicalVisibleInnerWidth,e.physicalVisibleInnerHeight,"auto"),d.dom.setAbsolutePosition.call(c,f.right.svg,e.physicalLeft+e.physicalVisibleInnerWidth,e.physicalTop+b,e.physicalRight,e.physicalVisibleInnerHeight),d.dom.setRelativePosition.call(c,f.bottom.svg,e.physicalLeft,e.physicalVisibleInnerWidth,e.physicalBottom,"hidden"),d.dom.setAbsolutePosition.call(c,f.top.left.svg,0,b,e.physicalLeft+e.dragHandleWidth/2,e.physicalTop),d.dom.setAbsolutePosition.call(c,f.top.right.svg,e.physicalLeft+e.physicalVisibleInnerWidth-e.dragHandleWidth/2,b,e.physicalRight+e.dragHandleWidth/2,e.physicalTop),d.dom.setAbsolutePosition.call(c,f.bottom.left.svg,0,e.physicalTop+e.physicalVisibleInnerHeight+b,e.physicalLeft,e.physicalBottom),d.dom.setAbsolutePosition.call(c,f.bottom.right.svg,e.physicalLeft+e.physicalVisibleInnerWidth,e.physicalTop+e.physicalVisibleInnerHeight+b,e.physicalRight,e.physicalBottom),d.dom.setAbsolutePosition.call(c,f.main.svg,e.physicalLeft,e.physicalTop+b,e.physicalVisibleInnerWidth,e.physicalVisibleInnerHeight),d.dom.stylePanels.call(this,this.style),f.top.right.transform.attr("transform","translate("+e.dragHandleWidth/2+", 0)"),f.main.viewport.on("scroll",function(){d.render.draw.call(c,!1,!1)}),d.dom.redirectViewportEvents.call(c),d.dom.setScrollerSize.call(c),e.verticalScrollbarWidth=f.main.viewport.node().offsetWidth-f.main.viewport.node().clientWidth,e.horizontalScrollbarHeight=f.main.viewport.node().offsetHeight-f.main.viewport.node().clientHeight},Scrollgrid.prototype.internal.dom.populateDOM=function(){"use strict";var a=this.internal,b=this.elements;b.parent=d3.select(this.target),b.container=b.parent.append("div"),b.left=a.dom.populatePanel.call(this),b.top=a.dom.populatePanel.call(this),b.top.left=a.dom.populatePanel.call(this),b.top.right=a.dom.populatePanel.call(this),b.main=a.dom.populatePanel.call(this),b.main.viewport=b.container.append("div"),b.right=a.dom.populatePanel.call(this),b.bottom=a.dom.populatePanel.call(this),b.bottom.left=a.dom.populatePanel.call(this),b.bottom.right=a.dom.populatePanel.call(this),b.main.scroller=b.main.viewport.append("div")},Scrollgrid.prototype.internal.dom.populatePanel=function(){"use strict";var a=this.elements,b={};return b.svg=a.container.append("svg"),b.transform=b.svg.append("g"),b.content=b.transform.append("g"),b},Scrollgrid.prototype.internal.dom.redirectViewportEvents=function(){"use strict";var a,b,c=this,d=c.elements;for(b=function(a,b){return function(){var c,d,e,f,g,h,i;c=d3.mouse(this),d=a.main.svg.node(),e=d.createSVGRect(),e.x=c[0],e.y=c[1],e.width=1,e.height=1,f=d.getIntersectionList(e,null),f.length&&(g=f[0].parentNode,h=d3.select(g),i=h.on(b),i&&i.call(g,h.datum()))}},a=0;a<this.eventHandlers.length;a+=1)d.main.viewport.on(this.eventHandlers[a].type,b(d,this.eventHandlers[a].type))},Scrollgrid.prototype.internal.dom.setAbsolutePosition=function(a,b,c,d,e){"use strict";return a.style("position","absolute").style("overflow","hidden").style("left",b+"px").style("top",c+"px").style("width",d+"px").style("height",e+"px")},Scrollgrid.prototype.internal.dom.setAutoResize=function(){"use strict";var a=this,b=window.onresize;window.onresize=function(){b&&b(),a.refresh(!0)}},Scrollgrid.prototype.internal.dom.setRelativePosition=function(a,b,c,d,e){"use strict";return a.style("overflow",e).style("position","relative").style("margin-left",b+"px").style("width",c+"px").style("height",d+"px")},Scrollgrid.prototype.internal.dom.setScrollerSize=function(){"use strict";var a=this.elements,b=this.properties;a.main.scroller.style("width",b.physicalTotalInnerWidth+"px").style("height",b.physicalTotalInnerHeight+"px")},Scrollgrid.prototype.internal.dom.stylePanels=function(a){"use strict";var b=this.elements;this.style=a||this.style,b.left.svg.attr("class",this.style.left.panel),b.top.svg.attr("class",this.style.top.panel),b.right.svg.attr("class",this.style.right.panel),b.bottom.svg.attr("class",this.style.bottom.panel),b.top.left.svg.attr("class",this.style.top.left.panel),b.top.right.svg.attr("class",this.style.top.right.panel),b.bottom.left.svg.attr("class",this.style.bottom.left.panel),b.bottom.right.svg.attr("class",this.style.bottom.right.panel),b.main.svg.attr("class",this.style.main.panel)},Scrollgrid.prototype.internal.events.addEventHandlers=function(a,b){"use strict";var c;for(a.attr("data-row",b.rowIndex).attr("data-col",b.columnIndex),c=0;c<this.eventHandlers.length;c+=1)a.on(this.eventHandlers[c].type,this.eventHandlers[c].listener,this.eventHandlers[c].capture)},Scrollgrid.prototype.internal.interaction.addResizeHandles=function(a,b,c){"use strict";var d=this,e=this.properties,f=this.style,g=this.internal,h=c||0;a.content.selectAll(".sg-no-style--handle-selector").remove(),a.content.selectAll(".sg-no-style--handle-selector").data(this.columns.slice(b.left,b.right)).enter().append("rect").attr("class","sg-no-style--handle-selector "+f.resizeHandle).attr("transform","translate("+-1*e.dragHandleWidth/2+", 0)").attr("x",function(a){return h+=a.width,a.x=h,a.x}).attr("y",0).attr("width",e.dragHandleWidth).attr("height",e.physicalTop).on("dblclick",function(a){g.interaction.autoResizeColumn.call(d,a)}).call(g.interaction.getColumnResizer.call(d))},Scrollgrid.prototype.internal.interaction.addSortButtons=function(a,b){"use strict";var c=this,d=this.internal;a.append("rect").attr("width",b.boxWidth).attr("height",b.boxHeight).style("opacity",0).style("cursor","pointer").on("click",function(){return d.interaction.sortColumn.call(c,b.columnIndex,!0)})},Scrollgrid.prototype.internal.interaction.autoResizeColumn=function(a){"use strict";var b,c=this.internal,d=this.elements,e=[d.top.left,d.top,d.top.right,d.left,d.main,d.right,d.bottom.left,d.bottom,d.bottom.right];for(a.width=0,b=0;b<e.length;b+=1)a.width=Math.max(a.width,c.sizes.getExistingTextBound.call(this,e[b].svg,a.index).width);this.refresh(!0)},Scrollgrid.prototype.internal.interaction.columnResizeEnd=function(a){"use strict";a.classed("dragging",!1)},Scrollgrid.prototype.internal.interaction.columnResizeStart=function(a){"use strict";d3.event.sourceEvent.stopPropagation(),a.classed("dragging",!0)},Scrollgrid.prototype.internal.interaction.columnResizing=function(a,b){"use strict";b.width-=b.x-d3.event.x,b.x=d3.event.x,b.width<0&&(b.width=0),a.attr("x",b.x),this.refresh(!0)},Scrollgrid.prototype.internal.interaction.defaultComparer=function(a,b){"use strict";var c;return c=isNaN(a)||isNaN(b)?new Date(a)-new Date(b):parseFloat(a)-parseFloat(b),isNaN(c)&&(c=a<b?-1:a>b?1:0),c},Scrollgrid.prototype.internal.interaction.getColumnResizer=function(){"use strict";var a=this.internal,b=this;return d3.behavior.drag().origin(function(a){return a}).on("dragstart",function(){a.interaction.columnResizeStart.call(b,d3.select(this))}).on("drag",function(c){a.interaction.columnResizing.call(b,d3.select(this),c)}).on("dragend",function(){a.interaction.columnResizeEnd.call(b,d3.select(this))})},Scrollgrid.prototype.internal.interaction.sortColumn=function(a,b){"use strict";var c,d=this.internal,e=this.properties;for(c=0;c<this.columns.length;c+=1)c!==a?delete this.columns[c].sort:b&&(this.columns[c].sort="desc"===this.columns[c].sort?"asc":"desc");this.adapter.sort(a,e.virtualTop,e.virtualBottom,"desc"===this.columns[a].sort,this.columns[a].compareFunction||d.interaction.defaultComparer),this.refresh(!1)},Scrollgrid.prototype.internal.raise=function(a){"use strict";var b=this.reporter||console;if(!b||!b.error)throw a;b.error(a)},Scrollgrid.prototype.internal.render.applyRules=function(a){"use strict";var b,c,d,e,f,g,h=this.internal,i=this.properties,j={};if(i.formatRules)for(d=0;d<a.length;d+=1){for(j={},f=a[d].rowIndex+1,g=a[d].columnIndex+1,e=0;e<i.formatRules.length;e+=1)if(b=i.formatRules[e],h.render.matchRule.call(this,b.row,f,i.virtualOuterHeight)&&h.render.matchRule.call(this,b.column,g,i.virtualOuterWidth))for(c in b)b.hasOwnProperty(c)&&"row"!==c&&"column"!==c&&(j[c]=b[c]);j.formatter&&(a[d].formatter=j.formatter),j.alignment&&(a[d].alignment=j.alignment),j.cellPadding&&(a[d].cellPadding=j.cellPadding),j.backgroundStyle&&(a[d].backgroundStyle+=" "+j.backgroundStyle),j.foregroundStyle&&(a[d].foregroundStyle+=" "+j.foregroundStyle),j.renderBackground&&(a[d].renderBackground=j.renderBackground),j.renderBetween&&(a[d].renderBetween=j.renderBetween),j.renderForeground&&(a[d].renderForeground=j.renderForeground)}},Scrollgrid.prototype.internal.render.calculateCellAdjustments=function(a,b){"use strict";var c=this.properties,d={x:0,y:0,boxHeight:0,boxWidth:0,textHeight:0,textWidth:0};return(a<c.virtualTop||a>=c.virtualOuterHeight-c.virtualBottom)&&b===c.virtualOuterWidth-c.virtualRight-1&&(d.boxWidth+=c.verticalScrollbarWidth),(b<c.virtualLeft||b>=c.virtualOuterWidth-c.virtualRight)&&a===c.virtualOuterHeight-c.virtualBottom-1&&(d.boxHeight+=c.horizontalScrollbarHeight),a===c.virtualTop-1&&(d.boxHeight-=1),a===c.virtualTop&&a>0&&(d.boxHeight+=1,d.y-=1),b===c.virtualLeft-1&&(d.boxWidth-=1),b===c.virtualLeft&&b>0&&(d.boxWidth+=1,d.x-=1),a===c.virtualOuterHeight-1&&(d.boxHeight-=1),b===c.virtualOuterWidth-1&&(d.boxWidth-=1),a===c.virtualTop-1&&(d.sortIcon=this.columns[b]?this.columns[b].sort:void 0),d},Scrollgrid.prototype.internal.render.cropText=function(a,b){"use strict";var c=a.node().getBBox().width,d=a.text(),e=c/d.length,f=Math.ceil(b/e)+1;for(a.datum().originalText=d,f<=0&&a.text("");c>b&&f>=0;)0===f?a.text(""):a.text(d.substring(0,f)),c=a.node().getBBox().width,f-=1},Scrollgrid.prototype.internal.render.draw=function(a,b){"use strict";var c,d,e=this.internal,f=this.properties,g=this.elements,h=e.render.getVisibleRegion.call(this),i=e.render.getDataBounds.call(this,h),j={},k=i.physical,l=i.virtual,m={top:{top:0,bottom:f.virtualTop},middle:{top:f.virtualTop+l.top,bottom:f.virtualTop+l.bottom},bottom:{top:f.virtualOuterHeight-f.virtualBottom,bottom:f.virtualOuterHeight}},n={left:{left:0,right:f.virtualLeft},middle:{left:f.virtualLeft+l.left,right:f.virtualLeft+l.right},right:{left:f.virtualOuterWidth-f.virtualRight,right:f.virtualOuterWidth}};e.render.renderRegion.call(this,g.top.left,{},n.left,m.top,a),e.render.renderRegion.call(this,g.top,{x:k.x},n.middle,m.top,a),e.render.renderRegion.call(this,g.top.right,{},n.right,m.top,a),e.render.renderRegion.call(this,g.left,{y:k.y},n.left,m.middle,a),e.render.renderRegion.call(this,g.main,{x:k.x,y:k.y},n.middle,m.middle,a),e.render.renderRegion.call(this,g.right,{y:k.y},n.right,m.middle,a),e.render.renderRegion.call(this,g.bottom.left,{},n.left,m.bottom,a),e.render.renderRegion.call(this,g.bottom,{x:k.x},n.middle,m.bottom,a),e.render.renderRegion.call(this,g.bottom.right,{},n.right,m.bottom,a),f.allowColumnResizing&&(e.interaction.addResizeHandles.call(this,g.top.left,n.left),e.interaction.addResizeHandles.call(this,g.top,n.middle,k.x),e.interaction.addResizeHandles.call(this,g.top.right,n.right)),b&&(c=f.physicalLeft+f.physicalTotalInnerWidth+f.physicalRight+f.verticalScrollbarWidth,j.width=c<g.parent.node().offsetWidth?c:null,d=f.physicalTop+f.physicalTotalInnerHeight+f.physicalBottom+f.horizontalScrollbarHeight,j.height=d<g.parent.node().offsetHeight?d:null,e.dom.layoutDOM.call(this,j))},Scrollgrid.prototype.internal.render.getClipPath=function(a){"use strict";var b=a.textWidth-a.cellPadding-(a.sortIcon&&"none"!==a.sortIcon?this.properties.sortIconSize+a.cellPadding:0)+"px",c=a.textHeight-a.cellPadding+"px";return"polygon(0px 0px, "+b+" 0px, "+b+" "+c+", 0px "+c+")"},Scrollgrid.prototype.internal.render.getDataBounds=function(a){"use strict";var b,c,d,e,f=this.properties,g=this.columns,h=0,i={physical:{x:0,y:0},virtual:{top:Math.max(Math.floor(f.virtualInnerHeight*(a.top/f.physicalTotalInnerHeight)-1),0),bottom:Math.min(Math.ceil(f.virtualInnerHeight*(a.bottom/f.physicalTotalInnerHeight)+1),f.virtualInnerHeight)}};for(i.physical.y=i.virtual.top*f.rowHeight-a.top,b=0;b<f.virtualInnerWidth;b+=1){if(c=g[b+f.virtualLeft].width,void 0===d&&(b===f.virtualInnerWidth-1||h+c>a.left)&&(d=b,i.physical.x=h-a.left),void 0===e&&(b===f.virtualInnerWidth-1||h+c>a.right)){e=b+1;break}h+=c}return i.virtual.left=Math.max(Math.floor(d),0),i.virtual.right=Math.min(Math.ceil(e+1),f.virtualInnerWidth),i},Scrollgrid.prototype.internal.render.getDataInBounds=function(a){"use strict";var b,c,d,e,f,g,h,i,j,k=0,l=this.internal,m=this.properties,n=this.columns,o=0,p=[];for(i=a.startY,c=a.top||0,b=0;c<a.bottom;c+=1){for(o=l.sizes.getRowHeight.call(this,c),h=a.startX||0,f=0,d=a.left||0;d<a.right;d+=1,b+=1)j=l.render.calculateCellAdjustments.call(this,c,d),g=n[d],e=Math.floor(h)+j.x+.5,p[b]={x:e,y:Math.floor(i)+j.y+.5,visibleRow:k,visibleColumn:f,boxWidth:Math.ceil(g.width)+j.boxWidth,boxHeight:Math.ceil(o)+j.boxHeight,textWidth:Math.ceil(g.width)+j.textWidth,textHeight:Math.ceil(o)+j.textHeight,backgroundStyle:this.style.cellBackgroundPrefix+"r"+(c+1)+" "+this.style.cellBackgroundPrefix+"c"+(d+1),foregroundStyle:this.style.cellForegroundPrefix+"r"+(c+1)+" "+this.style.cellForegroundPrefix+"c"+(d+1),sortIcon:j.sortIcon||"none",cellPadding:m.cellPadding,alignment:"left",rowIndex:c,columnIndex:d,column:g,formatter:null,renderForeground:l.render.renderForeground,renderBetween:null,renderBackground:l.render.renderBackground},p[b].key=p[b].columnIndex+"_"+p[b].rowIndex+"_"+p[b].boxHeight+"_"+p[b].boxWidth+"_"+p[b].sortIcon,f+=1,h+=g.width;k+=1,i+=o}return l.render.applyRules.call(this,p),p},Scrollgrid.prototype.internal.render.getTextAnchor=function(a){"use strict";var b="start";return"center"===a.alignment?b="middle":"right"===a.alignment&&(b="end"),b},Scrollgrid.prototype.internal.render.getTextPosition=function(a){"use strict";var b=this.properties,c=0;return"center"===a.alignment?c+=a.textWidth/2:"right"===a.alignment?c+=a.textWidth-a.cellPadding:(c+=a.cellPadding,a.sortIcon&&"none"!==a.sortIcon&&(c+=b.sortIconSize+a.cellPadding)),c},Scrollgrid.prototype.internal.render.getVisibleRegion=function(){"use strict";var a,b=this.elements;return a={},a.left=b.main.viewport.node().scrollLeft,a.top=b.main.viewport.node().scrollTop,a.right=a.left+b.main.viewport.node().clientWidth,a.bottom=a.top+b.main.viewport.node().clientHeight,a},Scrollgrid.prototype.internal.render.matchRule=function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m=!1;if(a&&"*"!==a)for(d=a.toString().replace(/\s/g,"").split(","),l=0;l<d.length&&(e=d[l].indexOf(":"),f=d[l].match(/(\-{0,1}[0-9]+)\(([0-9]+)\)(\-{0,1}[0-9]+)/),e!==-1?(h=parseFloat(d[l].substring(0,e)),g=1,i=parseFloat(d[l].substring(e+1))):f&&4===f.length?(h=parseFloat(f[1]),g=Math.max(parseFloat(f[2]),1),i=parseFloat(f[3])):(h=parseFloat(d[l]),g=1,i=h),h=h<0?c+h+1:h,i=i<0?c+i+1:i,j=Math.min(h,i),k=Math.max(h,i),!(m=j<=b&&k>=b&&(b-j)%g===0));l+=1);else m=!0;return m},Scrollgrid.prototype.internal.render.renderBackground=function(a,b){"use strict";a.append("rect").attr("class",b.backgroundStyle).attr("width",b.boxWidth).attr("height",b.boxHeight)},Scrollgrid.prototype.internal.render.renderForeground=function(a,b){"use strict";var c,d,e=this,f=this.internal,g=this.properties;a.selectAll(".sg-no-style--text-selector").remove(),d=a.append("text").attr("class","sg-no-style--text-selector "+b.foregroundStyle).attr("dy","0.35em").attr("x",f.render.getTextPosition.call(e,b)).attr("y",b.textHeight/2).style("text-anchor",f.render.getTextAnchor.call(e,b)).style("clip-path",f.render.getClipPath.call(e,b)),b.formatter?d.text(b.formatter(b.value)):d.text(b.value),c=d.node().style.clipPath,c&&""!==c||f.render.cropText.call(e,d,b.textWidth-b.cellPadding-(b.sortIcon&&"none"!==b.sortIcon?g.sortIconSize+b.cellPadding:0))},Scrollgrid.prototype.internal.render.renderRegion=function(a,b,c,d,e){"use strict";var f,g,h,i=this,j=this.internal,k=this.properties,l=this.elements;(c.left||0)!==(c.right||0)&&(d.top||0)!==(d.bottom||0)&&(h={startX:b.x||0,startY:b.y||0,top:d.top||0,bottom:d.bottom||0,left:c.left||0,right:c.right||0},g=j.render.getDataInBounds.call(i,h),e&&a.content.selectAll(".sg-no-style--cell-selector").remove(),f=a.content.selectAll(".sg-no-style--cell-selector").data(g,function(a){return a.key}),f.enter().append("g").attr("class","sg-no-style--cell-selector").each(function(b){var c=d3.select(this);b.renderBackground&&b.renderBackground.call(i,c,b),j.render.renderSortIcon.call(i,b,c,!(!b.sortIcon||"none"===b.sortIcon)),!k.allowSorting||a!==l.top&&a!==l.top.left&&a!==l.top.right||j.interaction.addSortButtons.call(i,c,b),j.events.addEventHandlers.call(i,c,b)}),j.render.renderRegionForeground.call(this,h,f),f.attr("transform",function(a){return"translate("+a.x+","+a.y+")"}),f.exit().remove())},Scrollgrid.prototype.internal.render.renderRegionForeground=function(a,b){"use strict";var c=this;this.adapter.loadDataRange.call(this,a,function(a){b.each(function(b){var d=d3.select(this);b.value=a[b.visibleRow][b.visibleColumn],b.renderBetween&&b.renderBetween.call(c,d,b),b.renderForeground&&b.renderForeground.call(c,d,b)})})},Scrollgrid.prototype.internal.render.renderSortIcon=function(a,b,c){"use strict";var d=this,e=this.internal,f=this.properties;c&&a.textWidth>a.cellPadding+f.sortIconSize&&b.append("g").datum(a.sortIcon).attr("class","sg-no-style--sort-icon-selector").attr("transform","translate("+(a.cellPadding+f.sortIconSize/2)+","+a.textHeight/2+")").call(function(a){return e.render.sortIcon.call(d,a)})},Scrollgrid.prototype.internal.render.setDefaultStyles=function(){"use strict";this.style={left:{panel:"sg-grid sg-fixed sg-left"},top:{panel:"sg-grid sg-fixed sg-top",left:{panel:"sg-grid sg-fixed sg-top sg-left"},right:{panel:"sg-grid sg-fixed sg-top sg-right"}},right:{panel:"sg-grid sg-fixed sg-right"},bottom:{panel:"sg-grid sg-fixed sg-bottom",left:{panel:"sg-grid sg-fixed sg-bottom sg-left"},right:{panel:"sg-grid sg-fixed sg-bottom sg-right"}},main:{panel:"sg-grid"},resizeHandle:"sg-resize-handle",cellBackgroundPrefix:"sg-cell-background-",cellForegroundPrefix:"sg-cell-foreground-",sortIcon:"sg-sort-icon"}},Scrollgrid.prototype.internal.render.sortIcon=function(a){"use strict";var b=a.append("path").attr("class",this.style.sortIcon),c=this.properties,d=c.sortIconSize;"asc"===a.datum()?b.attr("d","M "+d/2+" 0 L "+d+" "+d+" L 0 "+d+" z"):"desc"===a.datum()&&b.attr("d","M 0 0 L "+d+" 0 L "+d/2+" "+d+" z"),b.attr("transform","translate("+b.node().getBBox().width/-2+","+b.node().getBBox().height/-2+")")},Scrollgrid.prototype.internal.sizes.calculatePhysicalBounds=function(a){"use strict";var b,c=this.properties,d=this.elements;for(c.physicalLeft=0,b=0;b<c.virtualLeft;b+=1)c.physicalLeft+=this.columns[b].width;for(c.physicalTotalInnerWidth=0,b=c.virtualLeft;b<c.virtualOuterWidth-c.virtualRight;b+=1)c.physicalTotalInnerWidth+=this.columns[b].width;for(c.physicalRight=0,b=c.virtualOuterWidth-c.virtualRight;b<c.virtualOuterWidth;b+=1)c.physicalRight+=this.columns[b].width;c.physicalTop=c.virtualTop*c.headerRowHeight,c.physicalBottom=c.virtualBottom*c.footerRowHeight,c.physicalVisibleInnerWidth=d.container.node().offsetWidth-c.physicalLeft-c.physicalRight,c.physicalVisibleInnerHeight=d.container.node().offsetHeight-c.physicalTop-c.physicalBottom-a,c.physicalTotalInnerHeight=c.virtualInnerHeight*c.rowHeight},Scrollgrid.prototype.internal.sizes.calculateTextBound=function(a,b){"use strict";var c,d,e={width:0,height:0};return c=a.append("text").text(b),d=c.node().getBBox(),e.width=d.width,e.height=d.height,c.remove(),e},Scrollgrid.prototype.internal.sizes.getExistingTextBound=function(a,b,c){"use strict";var d=this.internal,e=this.properties,f={width:0,height:0};return a.selectAll("text").filter(function(a){return!(void 0!==b&&a.columnIndex!==b||void 0!==c&&a.rowIndex!==c)}).each(function(a){var b=a.sortIcon&&"none"!==a.sortIcon?e.sortIconSize+a.cellPadding:0;f=d.sizes.pushTextBound(f,d3.select(this),a.cellPadding,b)}),f},Scrollgrid.prototype.internal.sizes.getRowHeight=function(a){"use strict";var b=this.properties,c=0;return c=a<b.virtualTop?b.headerRowHeight:a<b.virtualOuterHeight-b.virtualBottom?b.rowHeight:b.footerRowHeight},Scrollgrid.prototype.internal.sizes.initialiseColumns=function(){"use strict";var a,b,c=this.internal,d=this.properties;for(this.columns=this.columns||[],a=0;a<d.virtualOuterWidth;a+=1)if(this.columns[a]=this.columns[a]||{},this.columns[a].width=this.columns[a].width||d.defaultColumnWidth,d.formatRules&&d.formatRules.length>0)for(b=0;b<d.formatRules.length;b+=1)c.render.matchRule.call(this,d.formatRules[b].column,a+1,d.virtualOuterWidth)&&(this.columns[a]={width:d.formatRules[b].columnWidth||this.columns[a].width,index:a,sort:d.formatRules[b].sort||this.columns[a].sort,compareFunction:d.formatRules[b].compareFunction||this.columns[a].compareFunction})},Scrollgrid.prototype.internal.sizes.pushTextBound=function(a,b,c,d){"use strict";var e,f=b.text();return b.text(b.datum().originalText||b.text()),e=b.node().getBBox(),e.width+2*c+d>a.width&&(a.width=e.width+2*c+d),e.height>a.height&&(a.height=e.height),b.text(f),a},Scrollgrid.adapters.json=function(a,b,c){"use strict";c=c||{};var d,e,f={},g={},h=b||[],i=a,j=c.rowSampleSize||100;if(0===h.length)for(e=0;e<Math.min(i.length,j);e+=1)for(d in i[e])i[e].hasOwnProperty(d)&&void 0===f[d]&&(f[d]=h.length,h.push(d));for(e=0;e<h.length;e+=1)g[h[e]]=h[e];return i.splice(0,0,g),{rowCount:function(){return i.length},columnCount:function(){return h.length},sort:function(a,b,c,d,e){var f,g=i.splice(0,b),j=i.splice(i.length-c);for(i.sort(function(b,c){return e(b[h[a]],c[h[a]])*(d?-1:1)}),f=g.length-1;f>=0;f-=1)i.splice(0,0,g[f]);for(f=0;f<j.length;f+=1)i.push(j[f])},loadDataRange:function(a,b){var c,d,e,f=[];for(c=a.top;c<a.bottom;c+=1){for(e=[],d=a.left;d<a.right;d+=1)e.push(i[c][h[d]]);f.push(e)}b(f)}}},Scrollgrid.adapters.simple=function(a,b){"use strict";b=b||{};var c,d=0,e=a,f=b.rowSampleSize||100;for(c=0;c<Math.min(e.length,f);c+=1)e[c]&&"[object Array]"===Object.prototype.toString.call(e[c])&&e[c].length>d&&(d=e[c].length);return{rowCount:function(){return e.length},columnCount:function(){return d},sort:function(a,b,c,d,f){var g,h=e.splice(0,b),i=e.splice(e.length-c);for(e.sort(function(b,c){return f(b[a],c[a])*(d?-1:1)}),g=h.length-1;g>=0;g-=1)e.splice(0,0,h[g]);for(g=0;g<i.length;g+=1)e.push(i[g])},loadDataRange:function(a,b){var c,d,f,g=[];for(c=a.top;c<a.bottom;c+=1){for(f=[],d=a.left;d<a.right;d+=1)f.push(e[c][d]);g.push(f)}b(g)}}},Scrollgrid.prototype.addFormatRules=function(a,b){"use strict";var c=this.properties,d=this.internal;return a&&(c.formatRules=c.formatRules.concat(a),d.sizes.initialiseColumns.call(this),b||this.refresh()),c.formatRules},Scrollgrid.prototype.allowColumnResizing=function(a,b){"use strict";var c,d=this.properties;return void 0===a?c=d.allowColumnResizing:(d.allowColumnResizing=a,c=this,b||this.refresh()),c},Scrollgrid.prototype.allowSorting=function(a,b){"use strict";var c,d=this.properties;return void 0===a?c=d.allowSorting:(d.allowSorting=a,c=this,b||this.refresh()),c},Scrollgrid.prototype.cellPadding=function(a,b){"use strict";var c,d=this.properties;return void 0===a?c=d.cellPadding:(d.cellPadding=a,c=this,b||this.refresh()),c},Scrollgrid.prototype.data=function(a,b){"use strict";var c,d=this.properties,e=this.internal;if(a){for("[object Array]"===Object.prototype.toString.call(a)?this.adapter=Scrollgrid.adapters.simple(a):this.adapter=a,d.virtualOuterHeight=this.adapter.rowCount(),d.virtualOuterWidth=this.adapter.columnCount(),e.sizes.initialiseColumns.call(this),c=0;c<this.columns.length;c+=1)"asc"!==this.columns[c].sort&&"desc"!==this.columns[c].sort||e.interaction.sortColumn.call(this,c,!1);d.virtualInnerWidth=d.virtualOuterWidth-d.virtualLeft-d.virtualRight,d.virtualInnerHeight=d.virtualOuterHeight-d.virtualTop-d.virtualBottom,b||this.refresh(!1)}return this.adapter},Scrollgrid.prototype.dragHandleWidth=function(a,b){"use strict";var c,d=this.properties;return void 0===a?c=d.dragHandleWidth:(d.dragHandleWidth=a,c=this,b||this.refresh()),c},Scrollgrid.prototype.footerColumns=function(a,b){"use strict";var c,d=this.properties;return void 0===a?c=d.virtualRight:(d.virtualRight=a,d.virtualInnerWidth=d.virtualOuterWidth-d.virtualLeft-d.virtualRight,c=this,b||this.refresh()),c},Scrollgrid.prototype.footerRowHeight=function(a,b){"use strict";var c,d=this.properties;return void 0===a?c=d.footerRowHeight:(d.footerRowHeight=a,c=this,b||this.refresh()),c},Scrollgrid.prototype.footerRows=function(a,b){"use strict";var c,d=this.properties;return void 0===a?c=d.virtualBottom:(d.virtualBottom=a,d.virtualInnerHeight=d.virtualOuterHeight-d.virtualTop-d.virtualBottom,c=this,b||this.refresh()),c},Scrollgrid.prototype.formatRules=function(a,b){"use strict";var c,d=this.internal,e=this.properties;return void 0===a?c=e.formatRules:(e.formatRules=a,d.sizes.initialiseColumns.call(this),c=this,b||this.refresh()),c},Scrollgrid.prototype.headerColumns=function(a,b){"use strict";var c,d=this.properties;return void 0===a?c=d.virtualLeft:(d.virtualLeft=a,d.virtualInnerWidth=d.virtualOuterWidth-d.virtualLeft-d.virtualRight,c=this,b||this.refresh()),c},Scrollgrid.prototype.headerRowHeight=function(a,b){"use strict";var c,d=this.properties;return void 0===a?c=d.headerRowHeight:(d.headerRowHeight=a,c=this,b||this.refresh()),c},Scrollgrid.prototype.headerRows=function(a,b){"use strict";var c,d=this.properties;return void 0===a?c=d.virtualTop:(d.virtualTop=a,d.virtualInnerHeight=d.virtualOuterHeight-d.virtualTop-d.virtualBottom,c=this,b||this.refresh()),c},Scrollgrid.prototype.on=function(a,b,c){"use strict";this.eventHandlers.push({type:a,listener:b,capture:c})},Scrollgrid.prototype.refresh=function(a){"use strict";var b=this.internal;b.dom.layoutDOM.call(this),b.render.draw.call(this,!a,!0),b.dom.setScrollerSize.call(this)},Scrollgrid.prototype.rowHeight=function(a,b){"use strict";var c,d=this.properties;return void 0===a?c=d.rowHeight:(d.rowHeight=a,c=this,b||this.refresh()),c},Scrollgrid.prototype.sortIconSize=function(a,b){"use strict";var c,d=this.properties;return void 0===a?c=d.sortIconSize:(d.sortIconSize=a,c=this,b||this.refresh()),c};