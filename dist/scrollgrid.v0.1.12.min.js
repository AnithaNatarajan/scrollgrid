!function(a,b){"use strict";if("object"==typeof exports)module.exports=b(require("d3"));else if("function"==typeof define&&define.amd)define(["d3"],function(c){return a.Scrollgrid=b(c),a.Scrollgrid});else if(a.d3)a.Scrollgrid=b(a.d3);else{if(!console||!console.warn)throw"scrollgrid requires d3 to run.  Are you missing a reference to the d3 library?";console.warn("scrollgrid requires d3 to run.  Are you missing a reference to the d3 library?")}}(this,function(a){"use strict";var b=function(b){var c=this,d=c.internal,e=d.render,f=d.dom;b=b||{},b.target?1!==a.select(b.target).length?d.raise('target should be a d3/jquery selector identifying a single div.  E.g. "#tableContainer" where you have a div with id "tableContainer".  Please check that your selector is matching 1 and only 1 div.'):(c.rowHeight=b.rowHeight||30,c.dragHandleWidth=b.dragHandleWidth||8,c.headerRowHeight=b.headerRowHeight||c.rowHeight,c.footerRowHeight=b.footerRowHeight||c.rowHeight,c.defaultColumnWidth=b.defaultColumnWidth||100,c.cellPadding=b.cellPadding||6,c.verticalAlignment=b.verticalAlignment||"top",c.allowColumnResizing=b.allowColumnResizing||!0,c.allowSorting=b.allowSorting||!0,c.headerRows=b.headerRows||0,c.footerRows=b.footerRows||0,c.headerColumns=b.headerColumns||0,c.footerColumns=b.footerColumns||0,c.target=b.target,e.setDefaultStyles.call(c),c.formatRules=b.formatRules||[],c.cellWaitText=b.cellWaitText||"loading...",c.sortIconSize=b.sortIconSize||7,f.populateDOM.call(c),c.data(b.data||b.adapter),b.autoResize&&f.setAutoResize.call(c)):d.raise('target is a required field, please provide a selector string for the container. The selector string should be a d3/jquery selector identifying a single div.  E.g. "#tableContainer" where you have a div with id "tableContainer".')};return b.init=function(a,c){return c.target=a,new b(c)},b.adapters={},b.prototype.internal={sizes:{virtual:{},physical:{}},interaction:{},dom:{},render:{}},b}),Scrollgrid.prototype.internal.dom.getTopMargin=function(a,b){"use strict";var c,d=this,e=0;return a&&a.height&&b&&(c=b.node().offsetHeight,"middle"===d.verticalAlignment?e=(c-a.height)/2:"bottom"===d.verticalAlignment&&(e=c-a.height-1)),e},Scrollgrid.prototype.internal.dom.layoutDOM=function(a){"use strict";var b,c=this,d=c.internal,e=d.dom,f=d.sizes,g=d.render,h=f.physical;e.parent.style("position","relative"),b=e.getTopMargin.call(c,a,e.parent),e.container.style("position","relative").style("width",a&&a.width?a.width+"px":"100%").style("height",a&&a.height?a.height+"px":"100%").style("padding-top",b+"px").style("font-size",0),e.container.node().offsetWidth>e.parent.node().offsetWidth&&e.container.style("width","100%"),e.container.node().offsetHeight>e.parent.node().offsetHeight&&e.container.style("margin-top","0px").style("height","100%"),f.calculatePhysicalBounds.call(c,b),e.setAbsolutePosition.call(c,e.left.svg,0,h.top+b,h.left,h.visibleInnerHeight),e.setRelativePosition.call(c,e.top.svg,h.left,h.visibleInnerWidth,h.top,"hidden"),e.setRelativePosition.call(c,e.main.viewport,h.left,h.visibleInnerWidth,h.visibleInnerHeight,"auto"),e.setAbsolutePosition.call(c,e.right.svg,h.left+h.visibleInnerWidth,h.top+b,h.right,h.visibleInnerHeight),e.setRelativePosition.call(c,e.bottom.svg,h.left,h.visibleInnerWidth,h.bottom,"hidden"),e.setAbsolutePosition.call(c,e.top.left.svg,0,b,h.left+c.dragHandleWidth/2,h.top),e.setAbsolutePosition.call(c,e.top.right.svg,h.left+h.visibleInnerWidth-c.dragHandleWidth/2,b,h.right+c.dragHandleWidth/2,h.top),e.setAbsolutePosition.call(c,e.bottom.left.svg,0,h.top+h.visibleInnerHeight+b,h.left,h.bottom),e.setAbsolutePosition.call(c,e.bottom.right.svg,h.left+h.visibleInnerWidth,h.top+h.visibleInnerHeight+b,h.right,h.bottom),e.setAbsolutePosition.call(c,e.main.svg,h.left,h.top+b,h.visibleInnerWidth,h.visibleInnerHeight),e.top.right.transform.attr("transform","translate("+c.dragHandleWidth/2+", 0)"),e.main.viewport.on("scroll",function(){g.draw.call(c,!1)}),e.setScrollerSize.call(c),h.verticalScrollbarWidth=e.main.viewport.node().offsetWidth-e.main.viewport.node().clientWidth,h.horizontalScrollbarHeight=e.main.viewport.node().offsetHeight-e.main.viewport.node().clientHeight},Scrollgrid.prototype.internal.dom.populateDOM=function(){"use strict";var a=this,b=a.internal,c=a.style,d=b.dom;d.parent=d3.select(a.target),d.container=d.parent.append("div"),d.left=d.populatePanel.call(a,c.left.panel),d.top=d.populatePanel.call(a,c.top.panel),d.top.left=d.populatePanel.call(a,c.top.left.panel),d.top.right=d.populatePanel.call(a,c.top.right.panel),d.main=d.populatePanel.call(a,c.main.panel),d.main.viewport=d.container.append("div"),d.right=d.populatePanel.call(a,c.right.panel),d.bottom=d.populatePanel.call(a,c.bottom.panel),d.bottom.left=d.populatePanel.call(a,c.bottom.left.panel),d.bottom.right=d.populatePanel.call(a,c.bottom.right.panel),d.main.scroller=d.main.viewport.append("div")},Scrollgrid.prototype.internal.dom.populatePanel=function(a){"use strict";var b=this,c=b.internal.dom,d={};return d.svg=c.container.append("svg"),d.svg.attr("class",a),d.transform=d.svg.append("g"),d.content=d.transform.append("g"),d},Scrollgrid.prototype.internal.dom.setAbsolutePosition=function(a,b,c,d,e){"use strict";return a.style("position","absolute").style("overflow","hidden").style("left",b+"px").style("top",c+"px").style("width",d+"px").style("height",e+"px")},Scrollgrid.prototype.internal.dom.setAutoResize=function(){"use strict";var a=this,b=window.onresize;window.onresize=function(){b&&b(),a.refresh(!0)}},Scrollgrid.prototype.internal.dom.setRelativePosition=function(a,b,c,d,e){"use strict";return a.style("overflow",e).style("position","relative").style("margin-left",b+"px").style("width",c+"px").style("height",d+"px")},Scrollgrid.prototype.internal.dom.setScrollerSize=function(){"use strict";var a=this,b=a.internal,c=b.dom,d=b.sizes,e=d.physical;c.main.scroller.style("width",e.totalInnerWidth+"px").style("height",e.totalInnerHeight+"px")},Scrollgrid.prototype.internal.interaction.addResizeHandles=function(a,b,c){"use strict";var d=this,e=d.internal,f=d.style,g=e.sizes,h=e.interaction,i=g.physical,j=c||0;a.content.selectAll(".sg-no-style--handle-selector").remove(),a.content.selectAll(".sg-no-style--handle-selector").data(d.columns.slice(b.left,b.right)).enter().append("rect").attr("class","sg-no-style--handle-selector "+f.resizeHandle).attr("transform","translate("+-1*d.dragHandleWidth/2+", 0)").attr("x",function(a){return j+=a.width,a.x=j,a.x}).attr("y",0).attr("width",d.dragHandleWidth).attr("height",i.top).on("dblclick",function(a){h.autoResizeColumn.call(d,a)}).call(h.getColumnResizer.call(d))},Scrollgrid.prototype.internal.interaction.addSortButtons=function(a,b){"use strict";var c=this,d=c.internal,e=d.interaction;a.append("rect").attr("width",b.boxWidth).attr("height",b.boxHeight).style("opacity",0).style("cursor","pointer").on("click",function(){return e.sortColumn.call(c,b.columnIndex,!0)})},Scrollgrid.prototype.internal.interaction.autoResizeColumn=function(a){"use strict";var b,c=this,d=c.internal,e=d.dom,f=d.sizes,g=[e.top.left,e.top,e.top.right,e.left,e.main,e.right,e.bottom.left,e.bottom,e.bottom.right];for(a.width=0,b=0;b<g.length;b+=1)a.width=Math.ceil(Math.max(a.width,f.getExistingTextBound.call(c,g[b].svg,a.index).width));c.refresh(!0)},Scrollgrid.prototype.internal.interaction.columnResizeEnd=function(a){"use strict";a.classed("dragging",!1)},Scrollgrid.prototype.internal.interaction.columnResizeStart=function(a){"use strict";d3.event.sourceEvent.stopPropagation(),a.classed("dragging",!0)},Scrollgrid.prototype.internal.interaction.columnResizing=function(a,b){"use strict";var c=this;b.width-=b.x-d3.event.x,b.x=d3.event.x,b.width<0&&(b.width=0),a.attr("x",b.x),c.refresh(!0)},Scrollgrid.prototype.internal.interaction.defaultComparer=function(a,b){"use strict";var c;return c=isNaN(a)||isNaN(b)?new Date(a)-new Date(b):parseFloat(a)-parseFloat(b),isNaN(c)&&(c=b>a?-1:a>b?1:0),c},Scrollgrid.prototype.internal.interaction.getColumnResizer=function(){"use strict";var a=this,b=a.internal,c=b.interaction;return d3.behavior.drag().origin(function(a){return a}).on("dragstart",function(){c.columnResizeStart.call(a,d3.select(this))}).on("drag",function(b){c.columnResizing.call(a,d3.select(this),b)}).on("dragend",function(){c.columnResizeEnd.call(a,d3.select(this))})},Scrollgrid.prototype.internal.interaction.sortColumn=function(a,b){"use strict";var c,d=this,e=d.internal,f=e.interaction;for(c=0;c<d.columns.length;c+=1)c!==a?delete d.columns[c].sort:b&&(d.columns[c].sort="desc"===d.columns[c].sort?"asc":"desc");d.adapter.sort(a,d.headerRows,d.footerRows,"desc"===d.columns[a].sort,d.columns[a].compareFunction||f.defaultComparer),d.refresh(!1)},Scrollgrid.prototype.internal.raise=function(a){"use strict";var b=this,c=b.reporter||console;if(!c||!c.error)throw a;c.error(a)},Scrollgrid.prototype.internal.render.applyRules=function(a){"use strict";var b,c,d,e,f,g,h=this,i=h.internal,j=i.render,k=i.sizes,l=k.virtual,m={};if(h.formatRules)for(d=0;d<a.length;d+=1){for(m={},f=a[d].rowIndex+1,g=a[d].columnIndex+1,e=0;e<h.formatRules.length;e+=1)if(b=h.formatRules[e],j.matchRule.call(h,b.row,f,l.outerHeight)&&j.matchRule.call(h,b.column,g,l.outerWidth))for(c in b)b.hasOwnProperty(c)&&"row"!==c&&"column"!==c&&(m[c]=b[c]);m.formatter&&(a[d].formatter=m.formatter),m.alignment&&(a[d].alignment=m.alignment),m.cellPadding&&(a[d].cellPadding=m.cellPadding),m.backgroundStyle&&(a[d].backgroundStyle+=" "+m.backgroundStyle),m.foregroundStyle&&(a[d].foregroundStyle+=" "+m.foregroundStyle),m.renderBackground&&(a[d].renderBackground=m.renderBackground),m.renderBetween&&(a[d].renderBetween=m.renderBetween),m.renderForeground&&(a[d].renderForeground=m.renderForeground)}},Scrollgrid.prototype.internal.render.calculateCellAdjustments=function(a,b){"use strict";var c=this,d=c.internal,e=d.sizes,f=e.virtual,g=e.physical,h={x:0,y:0,boxHeight:0,boxWidth:0,textHeight:0,textWidth:0};return(a<c.headerRows||a>=f.outerHeight-c.footerRows)&&b===f.outerWidth-c.footerColumns-1&&(h.boxWidth+=g.verticalScrollbarWidth),(b<c.headerColumns||b>=f.outerWidth-c.footerColumns)&&a===f.outerHeight-c.footerRows-1&&(h.boxHeight+=g.horizontalScrollbarHeight),a===c.headerRows-1&&(h.boxHeight-=1),a===c.headerRows&&a>0&&(h.boxHeight+=1,h.y-=1),b===c.headerColumns-1&&(h.boxWidth-=1),b===c.headerColumns&&b>0&&(h.boxWidth+=1,h.x-=1),a===f.outerHeight-1&&(h.boxHeight-=1),b===f.outerWidth-1&&(h.boxWidth-=1),a===c.headerRows-1&&(h.sortIcon=c.columns[b]?c.columns[b].sort:void 0),h},Scrollgrid.prototype.internal.render.cropText=function(a,b){"use strict";var c=a.node().getBBox().width,d=a.text(),e=c/d.length,f=Math.ceil(b/e)+1;for(a.datum().originalText=d,0>=f&&a.text("");c>b&&f>=0;)0===f?a.text(""):a.text(d.substring(0,f)),c=a.node().getBBox().width,f-=1},Scrollgrid.prototype.internal.render.draw=function(a){"use strict";var b,c,d=this,e=d.internal,f=e.render,g=e.interaction,h=e.sizes,i=e.dom,j=h.virtual,k=h.physical,l=f.getVisibleRegion.call(d),m=f.getDataBounds.call(d,l),n={},o=m.physical,p=m.virtual,q={top:{top:0,bottom:d.headerRows},middle:{top:d.headerRows+p.top,bottom:d.headerRows+p.bottom},bottom:{top:j.outerHeight-d.footerRows,bottom:j.outerHeight}},r={left:{left:0,right:d.headerColumns},middle:{left:d.headerColumns+p.left,right:d.headerColumns+p.right},right:{left:j.outerWidth-d.footerColumns,right:j.outerWidth}};f.renderRegion.call(d,i.top.left,{},r.left,q.top,a),f.renderRegion.call(d,i.top,{x:o.x},r.middle,q.top,a),f.renderRegion.call(d,i.top.right,{},r.right,q.top,a),f.renderRegion.call(d,i.left,{y:o.y},r.left,q.middle,a),f.renderRegion.call(d,i.main,{x:o.x,y:o.y},r.middle,q.middle,a),f.renderRegion.call(d,i.right,{y:o.y},r.right,q.middle,a),f.renderRegion.call(d,i.bottom.left,{},r.left,q.bottom,a),f.renderRegion.call(d,i.bottom,{x:o.x},r.middle,q.bottom,a),f.renderRegion.call(d,i.bottom.right,{},r.right,q.bottom,a),g.addResizeHandles.call(d,i.top.left,r.left),g.addResizeHandles.call(d,i.top,r.middle,o.x),g.addResizeHandles.call(d,i.top.right,r.right),b=k.left+k.totalInnerWidth+k.right+k.verticalScrollbarWidth,n.width=b<i.parent.node().offsetWidth?b:null,c=k.top+k.totalInnerHeight+k.bottom+k.horizontalScrollbarHeight,n.height=c<i.parent.node().offsetHeight?c:null,i.layoutDOM.call(d,n)},Scrollgrid.prototype.internal.render.getDataBounds=function(a){"use strict";var b,c,d,e,f=this,g=f.internal,h=f.columns,i=g.sizes,j=i.virtual,k=i.physical,l=0,m={physical:{x:0,y:0},virtual:{top:Math.max(Math.floor(j.innerHeight*(a.top/k.totalInnerHeight)-1),0),bottom:Math.min(Math.ceil(j.innerHeight*(a.bottom/k.totalInnerHeight)+1),j.innerHeight)}};for(m.physical.y=m.virtual.top*f.rowHeight-a.top,b=0;b<j.innerWidth;b+=1){if(c=h[b+f.headerColumns].width,void 0===d&&(b===j.innerWidth-1||l+c>a.left)&&(d=b,m.physical.x=l-a.left),void 0===e&&(b===j.innerWidth-1||l+c>a.right)){e=b+1;break}l+=c}return m.virtual.left=Math.max(Math.floor(d),0),m.virtual.right=Math.min(Math.ceil(e+1),j.innerWidth),m},Scrollgrid.prototype.internal.render.getDataInBounds=function(a){"use strict";var b,c,d,e,f,g,h,i,j,k=this,l=k.internal,m=l.sizes,n=l.render,o=m.physical,p=k.columns,q=0,r=[];for(h=a.startY,j=k.adapter.loadDataRange(a),c=a.top||0,b=0;c<a.bottom;c+=1){for(q=o.getRowHeight.call(k,c),g=a.startX||0,d=a.left||0;d<a.right;d+=1,b+=1)i=n.calculateCellAdjustments.call(k,c,d),f=p[d],e=Math.floor(g)+i.x+.5,r[b]={x:e,y:Math.floor(h)+i.y+.5,boxWidth:Math.ceil(f.width)+i.boxWidth,boxHeight:Math.ceil(q)+i.boxHeight,textWidth:Math.ceil(f.width)+i.textWidth,textHeight:Math.ceil(q)+i.textHeight,backgroundStyle:k.style.cellBackgroundPrefix+"r"+(c+1)+" "+k.style.cellBackgroundPrefix+"c"+(d+1),foregroundStyle:k.style.cellForegroundPrefix+"r"+(c+1)+" "+k.style.cellForegroundPrefix+"c"+(d+1),sortIcon:i.sortIcon||"none",cellPadding:k.cellPadding,alignment:"left",rowIndex:c,columnIndex:d,column:f,formatter:null,getValue:j,renderForeground:n.renderForeground,renderBetween:null,renderBackground:n.renderBackground},r[b].key=r[b].columnIndex+"_"+r[b].rowIndex+"_"+r[b].boxHeight+"_"+r[b].boxWidth+"_"+r[b].sortIcon,g+=f.width;h+=q}return n.applyRules.call(k,r),r},Scrollgrid.prototype.internal.render.getTextAnchor=function(a){"use strict";var b="start";return"center"===a.alignment?b="middle":"right"===a.alignment&&(b="end"),b},Scrollgrid.prototype.internal.render.getTextPosition=function(a){"use strict";var b=this,c=0;return"center"===a.alignment?c+=a.textWidth/2:"right"===a.alignment?c+=a.textWidth-a.cellPadding:(c+=a.cellPadding,a.sortIcon&&"none"!==a.sortIcon&&(c+=b.sortIconSize+a.cellPadding)),c},Scrollgrid.prototype.internal.render.getVisibleRegion=function(){"use strict";var a,b=this,c=b.internal,d=c.dom;return a={},a.left=d.main.viewport.node().scrollLeft,a.top=d.main.viewport.node().scrollTop,a.right=a.left+d.main.viewport.node().clientWidth,a.bottom=a.top+d.main.viewport.node().clientHeight,a},Scrollgrid.prototype.internal.render.matchRule=function(a,b,c){"use strict";var d,e,f,g,h,i=!1;if(a&&"*"!==a)for(d=a.toString().replace(/\s/g,"").split(","),h=0;h<d.length&&(e=d[h].indexOf(":"),-1!==e?(f=parseFloat(d[h].substring(0,e)),g=parseFloat(d[h].substring(e+1))):(f=parseFloat(d[h]),g=f),f=0>f?c+f+1:f,g=0>g?c+g+1:g,!(i=i||Math.min(f,g)<=b&&Math.max(f,g)>=b));h+=1);else i=!0;return i},Scrollgrid.prototype.internal.render.renderBackground=function(a,b){"use strict";a.append("rect").attr("class",b.backgroundStyle).attr("width",b.boxWidth).attr("height",b.boxHeight)},Scrollgrid.prototype.internal.render.renderForeground=function(a,b){"use strict";var c,d=this,e=d.internal,f=e.render;c=a.append("text").attr("class",b.foregroundStyle).attr("dy","0.35em").attr("x",f.getTextPosition.call(d,b)).attr("y",b.textHeight/2).style("text-anchor",f.getTextAnchor.call(d,b)).text(d.cellWaitText),b.getValue(b.rowIndex,b.columnIndex,function(a){b.formatter?c.text(b.formatter(a)):c.text(a),f.cropText.call(d,c,b.textWidth-b.cellPadding-(b.sortIcon&&"none"!==b.sortIcon?d.sortIconSize+b.cellPadding:0))})},Scrollgrid.prototype.internal.render.renderRegion=function(a,b,c,d,e){"use strict";var f,g,h=this,i=h.internal,j=i.render,k=i.dom,l=i.interaction;(c.left||0)!==(c.right||0)&&(d.top||0)!==(d.bottom||0)&&(g=j.getDataInBounds.call(h,{startX:b.x||0,startY:b.y||0,top:d.top||0,bottom:d.bottom||0,left:c.left||0,right:c.right||0}),e&&a.content.selectAll(".sg-no-style--cell-selector").remove(),f=a.content.selectAll(".sg-no-style--cell-selector").data(g,function(a){return a.key}),f.enter().append("g").attr("class","sg-no-style--cell-selector").each(function(b){var c=d3.select(this);b.renderBackground&&b.renderBackground.call(h,c,b),b.renderBetween&&b.renderBetween.call(h,c,b),b.renderForeground&&b.renderForeground.call(h,c,b),j.renderSortIcon.call(h,b,c,!(!b.sortIcon||"none"===b.sortIcon)),(a===k.top||a===k.top.left||a===k.top.right)&&l.addSortButtons.call(h,c,b)}),f.attr("transform",function(a){return"translate("+a.x+","+a.y+")"}),f.exit().remove())},Scrollgrid.prototype.internal.render.renderSortIcon=function(a,b,c){"use strict";var d=this,e=d.internal,f=e.render;c&&a.textWidth>a.cellPadding+d.sortIconSize&&b.append("g").datum(a.sortIcon).attr("class","sg-no-style--sort-icon-selector").attr("transform","translate("+(a.cellPadding+d.sortIconSize/2)+","+a.textHeight/2+")").call(function(a){return f.sortIcon.call(d,a)})},Scrollgrid.prototype.internal.render.setDefaultStyles=function(){"use strict";var a=this;a.style={left:{panel:"sg-fixed sg-left"},top:{panel:"sg-fixed sg-top",left:{panel:"sg-fixed sg-top-left"},right:{panel:"sg-fixed sg-top-right"}},right:{panel:"sg-fixed sg-right"},bottom:{panel:"sg-fixed sg-bottom",left:{panel:"sg-fixed sg-bottom-left"},right:{panel:"sg-fixed sg-bottom-right"}},main:{panel:"sg-grid"},resizeHandle:"sg-resize-handle",cellBackgroundPrefix:"sg-cell-background-",cellForegroundPrefix:"sg-cell-foreground-",sortIcon:"sg-sort-icon"}},Scrollgrid.prototype.internal.render.sortIcon=function(a){"use strict";var b=this,c=b.sortIconSize,d=a.append("path").attr("class",b.style.sortIcon);"asc"===a.datum()?d.attr("d","M "+c/2+" 0 L "+c+" "+c+" L 0 "+c+" z"):"desc"===a.datum()&&d.attr("d","M 0 0 L "+c+" 0 L "+c/2+" "+c+" z"),d.attr("transform","translate("+d.node().getBBox().width/-2+","+d.node().getBBox().height/-2+")")},Scrollgrid.prototype.internal.sizes.calculatePhysicalBounds=function(a){"use strict";var b,c=this,d=c.internal,e=d.sizes,f=e.virtual,g=e.physical;for(g.left=0,b=0;b<c.headerColumns;b+=1)g.left+=c.columns[b].width;for(g.totalInnerWidth=0,b=c.headerColumns;b<f.outerWidth-c.footerColumns;b+=1)g.totalInnerWidth+=c.columns[b].width;for(g.right=0,b=f.outerWidth-c.footerColumns;b<f.outerWidth;b+=1)g.right+=c.columns[b].width;g.top=c.headerRows*c.headerRowHeight,g.bottom=c.footerRows*c.footerRowHeight,g.visibleInnerWidth=d.dom.container.node().offsetWidth-g.left-g.right,g.visibleInnerHeight=d.dom.container.node().offsetHeight-g.top-g.bottom-a,g.totalInnerHeight=f.innerHeight*c.rowHeight},Scrollgrid.prototype.internal.sizes.calculateTextBound=function(a,b){"use strict";var c,d,e={width:0,height:0};return c=a.append("text").text(b),d=c.node().getBBox(),e.width=d.width,e.height=d.height,c.remove(),e},Scrollgrid.prototype.internal.sizes.getExistingTextBound=function(a,b,c){"use strict";var d=this,e=d.internal,f=e.sizes,g={width:0,height:0};return a.selectAll("text").filter(function(a){return!(void 0!==b&&a.columnIndex!==b||void 0!==c&&a.rowIndex!==c)}).each(function(a){var b=a.sortIcon&&"none"!==a.sortIcon?d.sortIconSize+a.cellPadding:0;g=f.pushTextBound(g,d3.select(this),a.cellPadding,b)}),g},Scrollgrid.prototype.internal.sizes.physical.getRowHeight=function(a){"use strict";var b=this,c=b.internal,d=c.sizes,e=d.virtual,f=0;return f=a<b.headerRows?b.headerRowHeight:a<e.outerHeight-b.footerRows?b.rowHeight:b.footerRowHeight},Scrollgrid.prototype.internal.sizes.physical.initialiseColumns=function(){"use strict";var a,b,c=this,d=c.internal,e=d.render,f=d.sizes,g=f.virtual;for(c.columns=c.columns||[],a=0;a<g.outerWidth;a+=1)if(c.columns[a]=c.columns[a]||{},c.columns[a].width=c.columns[a].width||c.defaultColumnWidth,c.formatRules&&c.formatRules.length>0)for(b=0;b<c.formatRules.length;b+=1)e.matchRule.call(c,c.formatRules[b].column,a+1,g.outerWidth)&&(c.columns[a]={width:c.formatRules[b].columnWidth||c.columns[a].width,index:a,sort:c.formatRules[b].sort||c.columns[a].sort,compareFunction:c.formatRules[b].compareFunction||c.columns[a].compareFunction})},Scrollgrid.prototype.internal.sizes.pushTextBound=function(a,b,c,d){"use strict";var e,f=b.text();return b.text(b.datum().originalText||b.text()),e=b.node().getBBox(),e.width+2*c+d>a.width&&(a.width=e.width+2*c+d),e.height>a.height&&(a.height=e.height),b.text(f),a},Scrollgrid.adapters.json=function(a,b,c){"use strict";c=c||{};var d,e,f={},g={},h=b||[],i=a,j=c.rowSampleSize||100;if(0===h.length)for(e=0;e<Math.min(i.length,j);e+=1)for(d in i[e])i[e].hasOwnProperty(d)&&void 0===f[d]&&(f[d]=h.length,h.push(d));for(e=0;e<h.length;e+=1)g[h[e]]=h[e];return i.splice(0,0,g),{rowCount:function(){return i.length},columnCount:function(){return h.length},sort:function(a,b,c,d,e){var f,g=i.splice(0,b),j=i.splice(i.length-c);for(i.sort(function(b,c){return e(b[h[a]],c[h[a]])*(d?-1:1)}),f=g.length-1;f>=0;f-=1)i.splice(0,0,g[f]);for(f=0;f<j.length;f+=1)i.push(j[f])},loadDataRange:function(){return function(a,b,c){c(i[a][h[b]]||0)}}}},Scrollgrid.adapters.simple=function(a,b){"use strict";b=b||{};var c,d=0,e=a,f=b.rowSampleSize||100;for(c=0;c<Math.min(e.length,f);c+=1)e[c]&&"[object Array]"===Object.prototype.toString.call(e[c])&&e[c].length>d&&(d=e[c].length);return{rowCount:function(){return e.length},columnCount:function(){return d},sort:function(a,b,c,d,f){var g,h=e.splice(0,b),i=e.splice(e.length-c);for(e.sort(function(b,c){return f(b[a],c[a])*(d?-1:1)}),g=h.length-1;g>=0;g-=1)e.splice(0,0,h[g]);for(g=0;g<i.length;g+=1)e.push(i[g])},loadDataRange:function(){return function(a,b,c){c(e[a][b]||0)}}}},Scrollgrid.prototype.data=function(a){"use strict";var b,c=this,d=c.internal,e=d.sizes,f=e.physical,g=e.virtual,h=d.interaction;if(a){for("[object Array]"===Object.prototype.toString.call(a)?c.adapter=Scrollgrid.adapters.simple(a):c.adapter=a,g.outerHeight=c.adapter.rowCount(),g.outerWidth=c.adapter.columnCount(),f.initialiseColumns.call(c),b=0;b<c.columns.length;b+=1)("asc"===c.columns[b].sort||"desc"===c.columns[b].sort)&&h.sortColumn.call(c,b,!1);g.innerWidth=g.outerWidth-c.headerColumns-c.footerColumns,g.innerHeight=g.outerHeight-c.headerRows-c.footerRows,c.refresh(!1)}return c.adapter},Scrollgrid.prototype.refresh=function(a){"use strict";var b=this,c=b.internal,d=c.render,e=c.dom;e.layoutDOM.call(b),d.draw.call(b,!a),e.setScrollerSize.call(b)};